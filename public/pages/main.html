<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{{.Title}}</title>
        <link rel="stylesheet" type="text/css" href="/styles/bootstrap/css/bootstrap.min.css">
        <script src="/scripts/jquery-3.2.1.min.js"></script>
        <script src="/styles/bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script>
            google.charts.load('current', {'packages':['corechart']});
            // google.charts.setOnLoadCallback(drawChart);
            // function drawChart() {
               
            // }

            $(document).ready(function() {
                
                $("#calculate").click(function() {

                    $("td[id^=ethereum-]").text("0");
                    $.get("ethereum_profit", {hashrate: $("#hashrate-ethereum").val()}, function(resp) {
                        obj = $.parseJSON(resp)
                        $("td[id=ethereum-day]").text(obj.per_day);
                        $("td[id=ethereum-week]").text(obj.per_week);
                        $("td[id=ethereum-month]").text(obj.per_month);
                        $("td[id=ethereum-year]").text(obj.per_year);
                    });

                    $("td[id^=zcash-]").text("0");
                    $.get("zcash_profit", {hashrate: $("#hashrate-zcash").val()}, function(resp) {
                        obj = $.parseJSON(resp)
                        $("td[id=zcash-day]").text(obj.per_day);
                        $("td[id=zcash-week]").text(obj.per_week);
                        $("td[id=zcash-month]").text(obj.per_month);
                        $("td[id=zcash-year]").text(obj.per_year);
                    });
                });

                $("#calculate-year").click(function() {
                    $.get("ethereum_prediction", {
                       hashrate: $("#hashrate-ethereum-year").val(),
                        power_consumption: $("#power-consumption-ethereum").val(),
                        power_cost: $("#power-cost-ethereum").val(),
                        initial_investment: $("#initial-investment-ethereum").val()
                    }, function(resp) {
                        obj = $.parseJSON(resp)
                        
                        var data = new google.visualization.DataTable();
                        data.addColumn('number', 'X');
                        data.addColumn('number', 'Profit');

                        var options = {
                            curveType: 'function',
                            legend: { position: 'bottom' }
                        };

                        var chart = new google.visualization.LineChart(document.getElementById('ether-chart'));
                        for (var i = 0; i < obj.length; i++) {
                            // alert(obj[i]);
                            var val = parseFloat(obj[i]);
						    data.addRow([i, val]);
                        }

                        $("#ether-chart").css("display", "");
                        chart.draw(data, options);
                    });
                });

                $('button[data-language]').click(function(event) {
                    var clicked$ = $(event.target);
                    var lang = clicked$.attr("data-language");
                    $.post("/set_language", {language: lang}, function() {
                        location.reload();
                    });
                });
            });
        </script>
    </head>

    <body>
        <nav class="navbar navbar-toggleable-md navbar-light bg-faded">
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="#">Calculator</a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <!--<a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>-->
                    </li>
                    <li class="nav-item">
                        <!--<a class="nav-link" href="#">Features</a>-->
                    </li>
                    <li class="nav-item">
                        <!--<a class="nav-link" href="#">Pricing</a>-->
                    </li>
                    <li class="nav-item">
                        <!--<a class="nav-link disabled" href="#">Disabled</a>-->
                    </li>
                </ul>

                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" class="btn {{if eq .Language "en"}} btn-primary {{else}} btn-secondary {{end}}" data-language="en">En</button>
                    <button type="button" class="btn {{if eq .Language "ru"}} btn-primary {{else}} btn-secondary {{end}}" data-language="ru">Ru</button>
                </div>
            </div>
        </nav>

        <div class="container" style="margin-top:3%">
            <div class="card text-center">
                <div class="card-header">
                    <h4>{{.CalculatorTitle}}</h4>
                </div>

                <!-- Calculator navigagion -->
                <div class="card-block" style="margin:1%">
                     <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <!-- Simple calculator tab -->
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#home" role="tab">{{.Simple}}</a>
                        </li>
                        <!-- Ethereum neural network calculator -->
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#profile" role="tab">{{.EthereumYear}}</a>
                        </li>
                    </ul>

                    <!-- Tab panes -->
                    <div class="tab-content">

                        <!-- Simple calculator body -->
                        <div class="tab-pane active" id="home" role="tabpanel">
                            <!-- Table with calculations -->
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Ethereum</th>
                                        <th>ZCash</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">{{.PerDay}}</th>
                                        <td id="ethereum-day">0</td>
                                        <td id="zcash-day">0</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">{{.PerWeek}}</th>
                                        <td id="ethereum-week">0</td>
                                        <td id="zcash-week">0</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">{{.PerMonth}}</th>
                                        <td id="ethereum-month">0</td>
                                        <td id="zcash-month">0</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">{{.PerYear}}</th>
                                        <td id="ethereum-year">0</td>
                                        <td id="zcash-year">0</td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- Form for simple calculator parametrs -->
                            <form class="form-inline">
                                <div class="row">
                                    <div class="col-12" >
                                        <input type="text" id="hashrate" class="form-control" placeholder="Hashrate ethereum H/s"/>
                                        <button id="calculate" type="button" class="btn btn-primary">{{.Calculate}}</button>
                                        <div class="dropdown" style="display: inline-block">
                                            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                Dropdown button
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- Ethereum neural network calculator -->
                        <div class="tab-pane" id="profile" role="tabpanel">
                            <!-- Div for profit chart -->
                            <div id="ether-chart" style="display: none; height: 60%"></div>
                            <!-- Form for ethereum neural network calculator parametrs -->
                            <form class="">
                                <div class="row">
                                    <div class="offset-lg-3 col-lg-6 form-group" >
                                        <label class="form-control-label" for="hashrate-ethereum-year">Hashrate:</label>
                                        <input type="text" id="hashrate-ethereum-year" class="form-control" placeholder="Hashrate ethereum H/s"/>
                                        
                                        <label class="form-control-label" for="power-consumption-ethereum">{{.PowerConsumption}}:</label>
                                        <input type="text" id="power-consumption-ethereum" class="form-control" placeholder="{{.PowerConsumption}}"/>
                                        
                                        <label class="form-control-label" for="power-cost-ethereum">{{.PowerCost}}:</label>
                                        <input type="text" id="power-cost-ethereum" class="form-control" placeholder="{{.PowerCost}}"/>
                                        
                                        <label class="form-control-label" for="initial-investment-ethereum">{{.InitialInvestment}}:</label>
                                        <input type="text" id="initial-investment-ethereum" class="form-control" placeholder="{{.InitialInvestment}}"/>
                                        
                                        <button id="calculate-year" type="button" class="btn btn-primary">{{.Calculate}}</button>
                                        
                                        <div class="dropdown" style="display: inline-block">
                                            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                Dropdown button
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>